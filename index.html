<!doctype html>
<html lang="bg">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Деба</title>
<meta name="robots" content="noindex, nofollow" />

<style>
:root { --bg:#D6E0AC; }

body{
  margin:0;
  height:100vh;
  background:var(--bg);
  overflow:hidden;
  font-family:system-ui,sans-serif;
}

/* --- TOP: LOGO --- */
#top{
  position:absolute;
  top:20px;
  left:0;
  right:0;
  display:flex;
  justify-content:center;
  z-index:3;
}

#debaLogo{
  width:min(720px,88vw);
  user-select:none;
  -webkit-user-drag:none;
}

/* --- MIDDLE: CRAWL --- */
#middle{
  position:absolute;
  top:20%;
  bottom:30%;
  left:0;
  right:0;
  display:flex;
  justify-content:center;
  pointer-events:none;
  perspective:700px;
  z-index:2;
}

.crawl{
  width:min(900px,92vw);
  color:rgba(40,40,40,0.55);
  font-size:clamp(14px,2vw,22px);
  font-weight:600;
  line-height:1.55;
  text-align:center;
  white-space:pre-line;
  transform-origin:50% 100%;
  transform:rotateX(55deg) translateY(60vh);
  animation:crawlMove 203s linear infinite;
}

@keyframes crawlMove{
  from { transform:rotateX(55deg) translateY(60vh); }
  to   { transform:rotateX(55deg) translateY(-240vh); }
}

/* --- BOTTOM: PIG --- */
#bottom{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:30vh;
  display:flex;
  justify-content:center;
  align-items:flex-end;
  z-index:3;
}

canvas{
  width:min(420px,90vw);
  height:100%;
}

/* status */
#status{
  position:fixed;
  bottom:10px;
  left:10px;
  font-size:12px;
  opacity:.7;
  padding:6px 8px;
  border-radius:8px;
  background:rgba(255,255,255,0.35);
}
</style>

<script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js",
    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/"
  }
}
</script>
</head>

<body>

<!-- TOP -->
<div id="top">
  <img id="debaLogo" src="assets/deba.png" alt="Деба">
</div>

<!-- MIDDLE -->
<div id="middle">
  <div class="crawl">
Словото, словото на мечовете
Словото е словото на мечовете… за да бъдат възстановени несправедливостите
Дори низките се надигнаха… пратеникът на решителните

Словото, словото на мечовете
Словото е словото на мечовете… за да бъдат възстановени несправедливостите
Дори низките се надигнаха… пратеникът на решителните

Ние сме онези, които градиха… крепостите си от черепи
Прогонихме царя на Хосрой… с камшик като военна плячка
Нашият пратеник е слънцето на истината…
  </div>
</div>

<!-- BOTTOM -->
<div id="bottom">
  <canvas id="pig"></canvas>
</div>

<div id="status">booting…</div>

<script type="module">
import * as THREE from "three";
import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";
import { DRACOLoader } from "three/addons/loaders/DRACOLoader.js";

const statusEl = document.getElementById("status");
const canvas = document.getElementById("pig");

const scene = new THREE.Scene();
const renderer = new THREE.WebGLRenderer({ canvas, alpha:true, antialias:true });
renderer.setPixelRatio(Math.min(devicePixelRatio,2));

const camera = new THREE.PerspectiveCamera(55,1,0.1,1000);
camera.position.set(0,0,4);

scene.add(new THREE.AmbientLight(0xffffff,0.8));
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(2,2,2);
scene.add(light);

const loader = new GLTFLoader();
const draco = new DRACOLoader();
draco.setDecoderPath("https://www.gstatic.com/draco/v1/decoders/");
loader.setDRACOLoader(draco);

let pig, baseScale;

loader.load("assets/pig.glb", gltf=>{
  pig = gltf.scene;
  scene.add(pig);

  pig.position.set(0,-0.3,0);
  baseScale = pig.scale.clone();

  statusEl.textContent="";
});

const BPM = 145;
const squash = 0.6;

function pulse(x){ return 0.5 - 0.5*Math.cos(x*Math.PI*2); }

function resize(){
  const r = canvas.getBoundingClientRect();
  renderer.setSize(r.width,r.height,false);
  camera.aspect = r.width/r.height;
  camera.updateProjectionMatrix();
}
addEventListener("resize",resize);
resize();

function animate(){
  requestAnimationFrame(animate);
  if(pig){
    const t = performance.now()*0.001;
    const beat = 60/BPM;
    const p = pulse((t/beat)%1);

    pig.scale.set(
      baseScale.x*(1+(squash-p)*1.2),
      baseScale.y*(1+p*2.0),
      baseScale.z*(1+(squash-p)*1.2)
    );

    pig.rotation.y = t*0.6;
  }
  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
