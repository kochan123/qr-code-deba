<!doctype html>
<html lang="bg">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–î–µ–±–∞</title>
<meta name="robots" content="noindex, nofollow" />

<style>
:root{
  --bg:#D6E0AC;

  /* light pink, a bit more pink than before */
  --crawl-color: rgba(210, 90, 170, 0.62);

  --logo-top: 20px;
  --logo-safe-gap: 18px;  /* space under logo where text should stop */
}

body{
  margin:0;
  height:100vh;
  background:var(--bg);
  overflow:hidden;
  font-family:system-ui,sans-serif;
}

/* TOP: LOGO */
#top{
  position:absolute;
  top:var(--logo-top);
  left:0; right:0;
  display:flex;
  justify-content:center;
  z-index:3;
  pointer-events:none;
}
#debaLogo{
  width:min(720px,88vw);
  user-select:none;
  -webkit-user-drag:none;
}

/* FLAT CRAWL AREA (bottom -> stops under logo) */
#middle{
  position:absolute;
  inset:0;
  z-index:2;
  pointer-events:none;
}

/* We animate this wrapper */
#crawlWrap{
  position:absolute;
  left:0; right:0;
  bottom:0;

  display:flex;
  justify-content:center;

  /* start off-screen until we start */
  transform: translateY(110%);
}

/* the text itself */
.crawl{
  width:min(900px,92vw);
  color:var(--crawl-color);

  font-size:clamp(15px,2.0vw,24px);
  font-weight:650;
  line-height:1.6;
  text-align:center;
  white-space:pre-line;

  text-shadow:
    0 1px 0 rgba(0,0,0,0.05),
    0 0 10px rgba(180,70,150,0.18);
}

/* status */
#status{
  position:fixed;
  bottom:10px;
  left:10px;
  font-size:12px;
  opacity:.7;
  padding:6px 8px;
  border-radius:10px;
  background:rgba(255,255,255,0.28);
  backdrop-filter: blur(8px);
  user-select:none;
  z-index:6;
}

/* AUDIO UNLOCK OVERLAY (nice, not ugly) */
#unlock{
  position:fixed;
  inset:0;
  z-index:10;
  display:none;              /* show only if autoplay is blocked */
  align-items:center;
  justify-content:center;
  background: radial-gradient(circle at center, rgba(0,0,0,0.18), rgba(0,0,0,0.0) 60%);
}

#unlockCard{
  width:min(520px,88vw);
  padding:18px 18px;
  border-radius:18px;

  background: rgba(255,255,255,0.14);
  border: 1px solid rgba(255,255,255,0.28);
  backdrop-filter: blur(14px);

  box-shadow: 0 10px 40px rgba(0,0,0,0.16);
  text-align:center;
  user-select:none;
  cursor:pointer;
}

#unlockTitle{
  font-weight:800;
  letter-spacing:0.3px;
  font-size:18px;
  color: rgba(25,25,25,0.92);
}

#unlockSub{
  margin-top:6px;
  font-size:12px;
  opacity:0.75;
  color: rgba(25,25,25,0.85);
}

#unlockHint{
  margin-top:10px;
  display:inline-block;
  padding:10px 14px;
  border-radius:999px;
  background: rgba(210, 90, 170, 0.20);
  border: 1px solid rgba(210, 90, 170, 0.35);
  color: rgba(25,25,25,0.92);
  font-weight:750;
}

/* optional: hide status on tiny screens */
@media (max-width: 420px){
  #status{ opacity:.55; }
}
</style>
</head>

<body>

<div id="top">
  <img id="debaLogo" src="assets/deba.png" alt="–î–µ–±–∞">
</div>

<div id="middle">
  <div id="crawlWrap">
    <div class="crawl" id="crawlText">
–°–ª–æ–≤–æ—Ç–æ, —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ

–°–ª–æ–≤–æ—Ç–æ, —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ

–°–ª–æ–≤–æ—Ç–æ, —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ

–ù–µ –º–æ–∂–∞—Ö–∞ –¥–∞ –æ—Å–∫–≤–µ—Ä–Ω—è—Ç —Å–≤–µ—Ç–∏–ª–∏—â–µ—Ç–æ –º–∏‚Ä¶ –¥–æ—Ä–∏ –ª—ä–≤–æ–≤–µ –¥–∞ –≥–∏ –æ–±–∫—Ä—ä–∂–∞–≤–∞—Ö–∞
–£—Ç–∞–π–∫–∞—Ç–∞ –Ω–∞ –ø–æ—Ç–∏—Å–Ω–∏—á–µ—Å—Ç–≤–æ—Ç–æ –Ω–∞–ø–∞–¥–Ω–∞‚Ä¶ –∫—ä–¥–µ –µ –∑–∞–≤–µ—Ç—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ?
–ó–∞–±—Ä–∞–≤–∏—Ö–∞, —á–µ —Å–º–µ –≥–æ—Ä–¥–∏‚Ä¶ –∑–∞—â–∏—Ç–∞–≤–∞–º–µ —Å–µ –∫–∞—Ç–æ —è—Ä–æ—Å—Ç–Ω–∏—Ç–µ
–ù–∏–µ —Å–º–µ –æ–Ω–µ–∑–∏, –∫–æ–∏—Ç–æ —Å—Ç—ä–ø–∫–∞—Ö–∞‚Ä¶ —Ç—Ä–æ–Ω–∞ –Ω–∞ —á—É–∂–¥–µ–Ω—Ü–∏—Ç–µ —Å –∫–æ–Ω–µ

–° –∫–æ–Ω–µ ‚Äì —Ç—Ä–æ–Ω–∞ –Ω–∞ —á—É–∂–¥–µ–Ω—Ü–∏—Ç–µ

–°–ª–æ–≤–æ—Ç–æ, —Å–ª–æ–≤–æ—Ç–æ ‚Äì –º–µ—á–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ

–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ

–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª–Ω–∏—Ç–µ

–ù–∏–µ —Å–º–µ –æ–Ω–µ–∑–∏, –∫–æ–∏—Ç–æ –≥—Ä–∞–¥–∏—Ö–∞‚Ä¶ –∫—Ä–µ–ø–æ—Å—Ç–∏—Ç–µ —Å–∏ –æ—Ç —á–µ—Ä–µ–ø–∏
–ü—Ä–æ–≥–æ–Ω–∏—Ö–º–µ —Ü–∞—Ä—è –Ω–∞ –•–æ—Å—Ä–æ–π‚Ä¶ —Å –∫–∞–º—à–∏–∫ –∫–∞—Ç–æ –≤–æ–µ–Ω–Ω–∞ –ø–ª—è—á–∫–∞
–ù–∞—à–∏—è—Ç –ø—Ä–∞—Ç–µ–Ω–∏–∫ –µ —Å—ä–∑–¥–∞–¥–µ–Ω –æ—Ç –Ω–∞—Å‚Ä¶ —Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –Ω–∞ –±–ª–∞–≥–æ—Ä–æ–¥–Ω–∞ —Å–ª–∞–≤–∞
–ù–∞—à–∏—è—Ç –ø—Ä–∞—Ç–µ–Ω–∏–∫ –µ —Å–ª—ä–Ω—Ü–µ—Ç–æ –Ω–∞ –∏—Å—Ç–∏–Ω–∞—Ç–∞‚Ä¶ –æ—Å–≤–µ—Ç–∏–ª –ª–∏—Ü–µ—Ç–æ –Ω–∞ —Å–≤–µ—Ç–æ–≤–µ—Ç–µ
–°–ª–æ–≤–æ—Ç–æ –µ —Å–ª–æ–≤–æ—Ç–æ –Ω–∞ –º–µ—á–æ–≤–µ—Ç–µ‚Ä¶ –∑–∞ –¥–∞ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏—Ç–µ
–î–æ—Ä–∏ –Ω–∏–∑–∫–∏—Ç–µ —Å–µ –Ω–∞–¥–∏–≥–Ω–∞—Ö–∞‚Ä¶ –ø—Ä–∞—Ç–µ–Ω–∏–∫—ä—Ç –Ω–∞ –Ω–∞—Ä–æ–¥–∞ –Ω–∞ —Ä–µ—à–∏–º–æ—Å—Ç—Ç–∞
    </div>
  </div>
</div>

<div id="status">ready</div>

<audio id="bgm" src="assets/music.mp3" loop preload="auto"></audio>

<div id="unlock">
  <div id="unlockCard" role="button" aria-label="Start audio">
    <div id="unlockTitle">–ü—É—Å–Ω–∏ –∑–≤—É–∫–∞ üîä</div>
    <div id="unlockSub">–ë—Ä–∞—É–∑—ä—Ä—ä—Ç –±–ª–æ–∫–∏—Ä–∞ autoplay. –ï–¥–∏–Ω tap –∏ —Ç—Ä—ä–≥–≤–∞.</div>
    <div id="unlockHint">TAP ANYWHERE</div>
  </div>
</div>

<script>
const statusEl = document.getElementById("status");
const audio = document.getElementById("bgm");
const unlock = document.getElementById("unlock");
const unlockCard = document.getElementById("unlockCard");

const crawlWrap = document.getElementById("crawlWrap");
const crawlText = document.getElementById("crawlText");
const logo = document.getElementById("debaLogo");

audio.volume = 1.0; // max the browser allows

let crawlRAF = null;
let crawlStartTime = null;
let crawlParams = null; // {startY, stopY, durationMs}

/* Compute where the crawl should stop (just under the logo) */
function computeCrawlParams(){
  const logoRect = logo.getBoundingClientRect();
  const textRect = crawlText.getBoundingClientRect();

  // Start from below bottom (hidden)
  const startY = window.innerHeight + 20;

  // Stop position: under logo + gap
  const stopY = logoRect.bottom + parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--logo-safe-gap")) || (logoRect.bottom + 18);

  // Duration: match music length if metadata exists, else 203s
  const fallbackSec = 203;
  const durationSec = (isFinite(audio.duration) && audio.duration > 1) ? audio.duration : fallbackSec;
  const durationMs = durationSec * 1000;

  // Apply initial placement
  crawlWrap.style.transform = `translateY(${startY}px)`;

  crawlParams = { startY, stopY, durationMs };
}

function startCrawl(){
  cancelAnimationFrame(crawlRAF);
  crawlStartTime = performance.now();

  computeCrawlParams();

  function step(now){
    const { startY, stopY, durationMs } = crawlParams;
    const t = (now - crawlStartTime) % durationMs;
    const p = t / durationMs;

    // Linear move from startY -> (stopY - textHeight - extra)
    // We want the text to scroll *through* and keep going upward,
    // but not vanish instantly. So we move it until it has passed the stop line.
    const textH = crawlText.getBoundingClientRect().height;

    // End point: move so the bottom of text ends around stopY (then continues past)
    // (More negative = farther up)
    const endY = stopY - textH - 40;

    const y = startY + (endY - startY) * p;
    crawlWrap.style.transform = `translateY(${y}px)`;

    crawlRAF = requestAnimationFrame(step);
  }

  crawlRAF = requestAnimationFrame(step);
}

/* Audio logic */
async function tryPlay(){
  try{
    await audio.play();
    unlock.style.display = "none";
    statusEl.textContent = "music on";
    startCrawl(); // crawl starts ONLY when audio successfully plays
  }catch(e){
    unlock.style.display = "flex";
    statusEl.textContent = "tap to enable sound";
  }
}

// If duration loads later, recompute so crawl syncs better
audio.addEventListener("loadedmetadata", () => {
  if (!audio.paused) startCrawl();
});

tryPlay();

function userGestureStart(){
  tryPlay();
}

// tap anywhere
unlock.addEventListener("pointerdown", userGestureStart);
unlockCard.addEventListener("pointerdown", userGestureStart);
window.addEventListener("pointerdown", userGestureStart, { passive:true });
window.addEventListener("keydown", userGestureStart);

// keep alive (some browsers pause audio)
setInterval(() => {
  if (!document.hidden && audio.paused) tryPlay();
}, 1500);

document.addEventListener("visibilitychange", () => {
  if (!document.hidden) tryPlay();
});

window.addEventListener("resize", () => {
  // keep crawl aligned under logo on resize
  if (!audio.paused) startCrawl();
});
</script>

</body>
</html>
